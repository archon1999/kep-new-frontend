<div
  class="content-wrapper container-xxl p-0">
  <div class="content-body">
    <!-- content-header component -->
    <app-content-header [contentHeader]="contentHeader"></app-content-header>

    <section class="mt-2">
      <div class="row">
        <div  class="col-lg-9 col-12 order-2 order-lg-1 d-flex flex-column gap-2">
          <kep-card>
            <div class="card-header p-2">
              <contest-tab [contest]="contest"></contest-tab>
            </div>
          </kep-card>

          <kep-card>
            <div class="card-body d-flex flex-wrap justify-content-between align-items-center gap-2 pb-0">
              <table-ordering
                (change)="orderingChange($event)"
                [ordering]="ratingOrderingKey"
                [value]="ordering"
                [justifyContent]="'start'">
                <span class="btn btn-sm" [ngClass]="isRatingOrderingActive() ? 'btn-primary' : 'btn-outline-primary'">
                  {{ 'Rating' | translate }}
                </span>
              </table-ordering>

              @if (!isLoading && total) {
                <span class="text-muted small">{{ total }} {{ 'Registrants' | translate }}</span>
              }
            </div>

            @if (isLoading) {
              <div class="card-body d-flex justify-content-center py-5">
                <spinner></spinner>
              </div>
            } @else if (!registrants.length) {
              <div class="card-body text-center py-5">
                <div class="text-muted">{{ 'NoResultFound' | translate }}</div>
              </div>
            } @else {
              <div class="table-responsive beautiful-table">
                <table class="table">
                  <thead>
                  <tr>
                    <th>#</th>
                    <th>
                      <kep-icon name="user"></kep-icon>
                      {{ 'User' | translate }}
                    </th>
                    <th>
                      <kep-icon name="rating"></kep-icon>
                    </th>
                  </tr>
                  </thead>
                  <tbody>
                    @for (registrant of registrants; track registrant.username) {
                      <tr>
                        <td class="text-dark">{{ registrant.rowIndex }}</td>
                        <td>
                          <contestant-view [team]="registrant.team" [user]="registrant"></contestant-view>
                        </td>
                        <td>
                          <span *ngIf="registrant.rating"
                                class="badge bg-{{ registrant.rating | contestsRatingColor }}-transparent">
                            {{ registrant.rating }}
                          </span>
                        </td>
                      </tr>
                    }
                  </tbody>
                </table>
              </div>
            }
          </kep-card>

          @if (total) {
            <kep-pagination
              (pageChange)="pageChange($event)"
              (pageSizeChange)="pageSizeChange($event)"
              [collectionSize]="total"
              [maxSize]="maxSize"
              [page]="pageNumber"
              [pageOptions]="pageOptions"
              [pageSize]="pageSize"
              [disabled]="isLoading"
              [rotate]="true">
            </kep-pagination>
          }

        </div>

        <div  class="col-lg-3 col-12 order-1 order-lg-2">
          @if (contest) {
            <contest-card-countdown [contest]="contest"></contest-card-countdown>
          }
        </div>
      </div>

    </section>
  </div>
</div>
